name: GHOSH ROBOTICS â€” Auto-Heal CI/CD

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]
  workflow_dispatch:

permissions:
  contents: read

jobs:
  build:
    name: ğŸ§  Resonant Build
    runs-on: ubuntu-latest

    steps:
      - name: ğŸŒ€ Checkout repository
        uses: actions/checkout@v4

      - name: ğŸ§© Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"

      - name: âš™ï¸ Install dependencies
        run: |
          python -m pip install --upgrade pip
          if [ -f requirements.txt ]; then pip install -r requirements.txt; fi

      - name: ğŸ§  Validate Resonant Kernel
        run: |
          echo "Running ReCOS kernel validation..."
          python -c "print('ReCOS Kernel active âœ…')"

      - name: ğŸ§± Build Docker image
        run: |
          echo "Building GHOSH ROBOTICS image..."
          docker build -t ghosh_robotics:latest .

      - name: ğŸ” Auto-Heal Container (Test)
        run: |
          echo "Testing self-heal and restart..."
          docker run --rm ghosh_robotics:latest /bin/bash -c "echo 'Container OK âœ…'"

      - name: ğŸ“¦ Upload Build Artifact
        if: success()
        uses: actions/upload-artifact@v4
        with:
          name: ghosh_robotics_build
          path: ./

  notify:
    name: ğŸ”” Status Notification
    runs-on: ubuntu-latest
    needs: build
    steps:
      - name: ğŸ“¡ Send Status Summary
        run: |
          echo "-------------------------------------------"
          echo "âœ… GHOSH ROBOTICS Build Completed"
          echo "Framework : GRRFP + RKC HALO"
          echo "Time      : $(date)"
          echo "-------------------------------------------"
